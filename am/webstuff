# -*- makefile -*-
# $Id$

## rules to create HTML-pages from wml-files with additional magic to
## possibly use the layout of the Dune-homepage

# if DUNEWEBDIR is set to the dune-web directory the layout and
# install-stuff from that place will be used

# CURDIR should be defined in the same way as in dune-web

# pass files through wrapper
# pass variables to wmlwrap via environment
if WML

.wml.html:
	export DUNEWEBDIR=$(DUNEWEBDIR); \
	export BASEDIR=$(BASEDIR); \
	sh $(DUNE_COMMON_ROOT)/bin/wmlwrap -I $(srcdir) $< -o $@

web-install-default: all
	if test -d $(DUNEWEBDIR) && test -r $(DUNEWEBDIR)/Make.global ; then \
	  for DIR in $(SUBDIRS) ; do \
	    $(MAKE) -C $$DIR web-install || exit 1; \
	  done ; \
	  $(MAKE) -f $(DUNEWEBDIR)/Make.global \
            EXTRAINSTALL="$(EXTRAINSTALL)" CURDIR="$(CURDIR)" install ; \
	fi

endif

web-install: web-install-default
